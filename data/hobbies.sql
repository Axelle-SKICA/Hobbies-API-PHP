BEGIN;

CREATE TABLE category
(id INT NOT NULL AUTO_INCREMENT,
name VARCHAR(255) NOT NULL,
created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
updated_at TIMESTAMP,
PRIMARY KEY (ID));

CREATE TABLE level
(id INT NOT NULL AUTO_INCREMENT,
name VARCHAR(255) NOT NULL,
created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
updated_at TIMESTAMP,
PRIMARY KEY (ID));

CREATE TABLE hobby
(id INT NOT NULL AUTO_INCREMENT,
name VARCHAR(255) NOT NULL,
start_year YEAR NOT NULL DEFAULT 1990,
level_id INT NOT NULL,
created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
updated_at TIMESTAMP,
PRIMARY KEY (ID),
FOREIGN KEY (level_id) REFERENCES level(id));

CREATE TABLE hobby_has_category
(id INT NOT NULL AUTO_INCREMENT,
hobby_id INT NOT NULL,
category_id INT NOT NULL,
created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
updated_at TIMESTAMP,
PRIMARY KEY (ID),
FOREIGN KEY (hobby_id) REFERENCES hobby(id),
FOREIGN KEY (category_id) REFERENCES category(id),
CONSTRAINT UC_hobby_category UNIQUE(hobby_id,category_id)
);

COMMIT;
